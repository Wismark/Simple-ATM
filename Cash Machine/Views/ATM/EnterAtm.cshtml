
@{
    ViewBag.Title = "EnterAtm";
}
<div class="container">
    <div id="header">     
    </div>
    <div id="result"><p class="form-control"></p></div>
    <div id="calc">                
        <div id="">
            <div id="num">
                <div class="row">
                    <button class="btn btn-info" value="1">1</button>
                    <button class="btn btn-info" value="2">2</button>
                    <button class="btn btn-info" value="3">3</button>
                    <button class="btn btn-info" value="4">4</button>
                    <button class="btn btn-info" value="5">5</button>
                </div>
                <div class="row">
                    <button class="btn btn-info" value="6">6</button>
                    <button class="btn btn-info" value="7">7</button>
                    <button class="btn btn-info" value="8">8</button>
                    <button class="btn btn-info" value="9">9</button>
                    <button class="btn btn-info" value="0">0</button>
                </div>
            </div>
            <div class="row">
                <button class="btn  btn-primary btn-delete" value="ce">CE</button>
                <button class="btn btn-primary " value="ac">Clear</button>
                <button class="btn btn-primary " value="OK">OK</button>
            </div>
        </div>
    </div>
</div>



@section scripts
{
    <script type="text/javascript">

        $(document).ready(function() {
            var eq = "";
            var curNumber = "";
            var entry = "";
            var reset = false;

            $("button").click(function() {
                entry = $(this).attr("value");

                var elements = document.getElementsByClassName("btn-info");
                if (entry === "ac") {
                    elements = document.getElementsByClassName("btn-info");
                    for (var i = 0; i < elements.length; i++) {
                        elements[i].disabled = false;
                    }
                    entry = "";
                    eq = "";
                    result = "";
                    curNumber = "";
                    $('#result p').html(entry);
                    $('#info p').html(eq);
                } else
                if (entry === "ce") {
                    for (var i = 0; i < elements.length; i++) {
                        elements[i].disabled = false;
                    }
                    curNumber = document.getElementById("result").innerText;
                    if (curNumber.length === 5 || curNumber.length === 10 || curNumber.length === 15) {                
                        curNumber = curNumber.slice(0, -2);
                        $('#result p').html(curNumber);
                    }
                    else {
                        if (eq.length > 1) {
                            eq = eq.slice(0, -1);
                            $('#previous p').html(eq);
                        } else {
                            eq = "";
                            $('#result p').html(eq);
                        }

                        $('#previous p').html(eq);

                        if (curNumber.length > 1) {
                            curNumber = curNumber.slice(0, -1);
                            $('#result p').html(curNumber);
                        } else {
                            curNumber = 0;
                            $('#result p').html();
                        }
                    }

                } else if (entry === "OK") {
                    var str = document.getElementById("result").innerText;
                    alert(str);
                    //result = eval(eq);
                    //$('#result p').html(result);
                    //eq += "=" + result;
                    //$('#previous p').html(eq);
                    //eq = result;
                    //entry = result;
                    //curNumber = result;
                    //reset = true;
                } else if (isNaN(entry)
                ) { //check if is not a number, and after that, prevents for multiple "." to enter the same number                   
                    if (entry !== ".") {
                        reset = false;
                        if (curNumber === "" || eq === "") {
                            curNumber = "";
                            eq = entry;
                        } else {
                            curNumber = "";
                            eq += entry;
                        }
                        $('#previous p').html(eq);
                    } else if (curNumber.indexOf(".") === -1) {
                        reset = false;
                        if (curNumber === 0 || eq === 0) {
                            curNumber = 0.;
                            eq = 0.;
                        } else {
                            curNumber += entry;
                            eq += entry;
                        }
                        $('#result p').html(curNumber);
                    }
                } else {
                    if (reset) {
                        eq = entry;
                        curNumber = entry;
                        reset = false;
                    } else {
                        eq += entry;
                        curNumber += entry;
                    }
                    $('#result p').html(curNumber);
                }

                if ((curNumber.length === 4 || curNumber.length === 9 || curNumber.length === 14) ) {
                    curNumber += "-";
                    $('#result p').html(curNumber);
                }
                if (curNumber.length > 18 || eq.length > 26) {
                    for (var i = 0; i < elements.length; i++) { //1234-1234-1234-1234
                        elements[i].disabled = true;
                    }
                    //$("#result p").html("");
                    //curNumber = "";
                    //eq = "";
                    //result = "";
                    //reset = true; 
                }

                //if (result.indexOf(".") !== -1) {
                //    result = result.truncate()
                //}

            });
        });
    </script>
}